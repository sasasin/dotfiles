---
- name: remove some packages
  apt: name={{ item }} state=absent
  with_items:
    - plymouth
    - libplymouth5

- name: apt-get update
  apt: update_cache=yes
  check_mode: no
  failed_when: no
  register: res
  changed_when: res.cache_updated != true

- name: apt-get dist-upgrade
  apt: upgrade=dist

- name: add apt-keys
  apt_key: url={{ item }} state=present
  with_items:
    - "https://dl-ssl.google.com/linux/linux_signing_key.pub"
    - "https://download.docker.com/linux/ubuntu/gpg"
    - "https://apt.enpass.io/keys/enpass-linux.key"
    - "https://packages.microsoft.com/keys/microsoft.asc"
    - "http://deb.tableplus.com/apt.tableplus.com.gpg.key"

- apt_repository: repo={{ item }} state=present
  with_items:
    - "deb http://download.virtualbox.org/virtualbox/debian {{ ansible_distribution_release }} contrib"
    - "deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_distribution_release }} stable"
    - "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main"
    - "deb https://apt.enpass.io/ stable main"
    - "deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main"
    - "deb [arch=amd64] https://deb.tableplus.com/debian tableplus main"

- name: apt-get update
  apt: update_cache=yes
  check_mode: no
  failed_when: no
  register: res
  changed_when: res.cache_updated != true

- name: install some packages
  apt: name={{ item }} state=present
  with_items:
    - apparmor-utils
    - apt-transport-https
    - autoconf
    - bridge-utils
    - build-essential
    - ca-certificates
    - chrome-gnome-shell
    - cifs-utils
    - code
    - composer
    - curl
    - default-jdk
    - default-jdk-doc
    - dkms
    - docker-ce
    - docker-compose
    - dstat
    - enpass
    - exfat-fuse
    - fcitx-skk
    - ffmpeg
    - fish
    - fonts-ricty-diminished
    - gimp
    - git
    - git-core
    - gnome-shell-extensions
    - gnome-system-monitor
    - gnome-terminal
    - gnome-tweak-tool
    - golang
    - google-chrome-stable
    - gparted
    - ibus
    - ibus-skk
    - imagemagick
    - kbuild
    - kernel-package
    - language-pack-gnome-ja
    - language-pack-ja
    - language-selector-gnome
    - libimage-size-perl
    - libjpeg-turbo-progs
    - libmoose-perl
    - libncurses5-dev
    - libpdf-create-perl
    - lm-sensors
    - lsb
    - lynx
    - micro
    - ncftp
    - ncurses-dev
    - network-manager-l2tp    
    - network-manager-l2tp-gnome
    - network-manager-openvpn
    - network-manager-openvpn-gnome
    - network-manager-vpnc
    - network-manager-vpnc-gnome
    - ooo-thumbnailer
    - openssl
    - openvpn
    - optipng
    - pdftk
    - peco
    - perltidy
    - pngnq
    - poppler-data
    - ppa-purge
    - qemu-kvm
    - ripgrep
    - ruby-all-dev
    - skkdic
    - skkdic-cdb
    - skkdic-extra
    - skksearch
    - sloccount
    - software-properties-common
    - solaar
    - solaar-gnome3
    - sqlite3
    - ssh
    - synaptic
    - sysstat
    - tableplus
    - ubuntu-fan
    - unpaper
    - usb-creator-gtk
    - vim
    - virt-manager
    - virtualbox-6.1
    - xbindkeys
    - xclip
    - xvkbd
    - zlib1g
    - zlib1g-dev

- name: remove some packages
  apt: name={{ item }} state=absent
  with_items:
    - plymouth
    - libplymouth4

- name: install language-support
  shell: apt-get install -y $(check-language-support)
  register: res
  changed_when: res.rc != 0

## https://booleestreet.net/archives/10321#i-5
#- name: put wakenet.sh
#  copy: src=wakenet.sh dest=/etc/pm/sleep.d/wakenet.sh mode=0755

- name: put rc.local
  copy: src=rc.local dest=/etc/rc.local
